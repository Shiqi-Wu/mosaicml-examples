# DeepEmbed DNABERT
## Contents
You'll find in this folder:
### Model Architecture
- `src/DNATextTokenizers.py` - The `DNATextUnifiedTokenizer` which can tokenize string data using separate Text tokenizer (Mosaicml-Bert Tokenizer) and DNA tokenizer (At initial stage we use DNABERT2 Tokenizer). 
- `src/dna_text_biembedder.py` - `DNATextBiEmbedding` class which can embed token ids encoded by `DNATextUnifiedTokenizer'. The text part will be embedded by Mosaicml-Bert embeddings, while the dna part's embeddings will be generated by a small transformer from basewise representation.

## Detailed Information of Scripts
### `src/DNATextTokenizers.py` 
- The `DNATextUnifiedTokenizer` class. The DNA part in a sentence is identified by special tag `<dna>`. One example input is: "TP53 is important: \<dna>ATGCGT\<dna>."
- The output of the tokenizer would be a dictionary:
    ```
    {
        "input_ids": torch.tensor([input_ids], dtype=torch.long),
        "modality_mask": torch.tensor([modality_mask], dtype=torch.long),
        "attention_mask": torch.tensor([attention_mask], dtype=torch.long),
    }
    ```
    Here, text tokens would be transfered to the same token ids as text tokenizer (Mosaicml-Bert Tokenizer), where dna tokens would be transfered to `token ids in dna tokenizer + dna_offset (usually set as the same as the vocab_size of text tokenizer)`.

    modality_mask is a list of bool, indicating whether the corresponding token is a dna token. modality_mask is set as 1 if the corresponding token is a dna token.
    attention_mask is set as 1 as default.
- run `python src/DNATextTokenizers.py` to build a DNATextUnifiedTokenizer. This tokenizer will be saved in `./saved_models/tokenizer_ckpt`. You can change the save dir and the based tokenizers by changing a few lines in `src/DNATextTokenizers.py`.

[figures/DNATextUnifiedTokenizer.jpg]
